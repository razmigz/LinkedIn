---
title: "LinkedIn"
author: "Razmig Zeitounian"
date: "7/23/2021"
output: html_document
---

Data Source: https://www.kaggle.com/killbot/linkedin-profiles-and-jobs-data 

```{r, message=FALSE}
library(tidyverse)
df <- read_csv("dump.csv") %>% 
  # drop ID column
  select(-X1)

# we will treat country as a factor (rather than as a character) since it is a variable with one level (au)
df$country <- as.factor(df$country)

# a function with two arguments. takes a vector x to check if it as least 500 and creates a new column y
at.least.500 <- function(x, y){
  y <- rep(NA, length(x))
  if (x >= 500){
    df$y = TRUE
  } else {
    df$y = FALSE
  }
}

sapply(df$connectionsCount, at.least.500)

# create a new column to check if a person has at least 500 connections using handmade function
df$connectionsCount %>% 
  map(at.least.500) %>% 
  map_lgl(at.least.500)

# create a new column to check if a person has at least 500 connections using handmade function
atLeast500 <- df %>% 
  pull(connectionsCount) %>% 
  map_lgl(at.least.500)

df2 <- df %>% 
  bind_cols(atLeast500) %>% 
  rename(atLeast500c = ...28)
```

We show a quick preview of our data to make the data easier to understand.

```{r}
head(df, 10)
```

In particular, our variables are as follows.

```{r}
colnames(df)
```


Let's see the top 50 companies to work for from our sample. 

```{r}
(top.50.companies <- df %>% 
  group_by(companyName) %>% 
  count() %>% 
  arrange(desc(n)) %>% 
  head(50)
)
```

We can visualize the number of employees at each company with a barplot.

```{r}
# we will reorder to show the companies with the most employees at the top of the chart for readability
ggplot(top.50.companies, aes(x=reorder(companyName, n), y=n)) +
  geom_bar(stat = "identity", fill = "seagreen2", col = "pink") +
  coord_flip() +
  labs(x = "Company", y = "Number of Employees on LinkedIn", title = "Number of Employees Per Company on LinkedIn") 
```

Telstra has the most employees on LinkedIn by a good amount. 
We start by checking how many observations we have and seeing how many of these individuals have at least 500 connections.

```{r}
dim(df)
at.least.500c <- df %>% 
  count(connectionsCount >= 500)
ggplot(as.data.frame(at.least.500c), aes(n)) + geom_bar()

ggplot(as.data.frame(at.least.500c), aes(`connectionsCount >= 500`, n, label = n)) + 
  geom_bar(stat = "identity", col = "blue", fill = "pink") +
  labs(x = "User has 500+ Connections", title = "Number of LinkedIn Users with 500+ Connections") +
  geom_text(hjust = 0.5, vjust = 10.5)
```

Another area we may be interested in is the age distribution of LinkedIn members.

```{r}
ggplot(df, aes(ageEstimate)) +
  geom_histogram(col = "cornsilk2", fill = "indianred", binwidth = 5) +
  labs(title = "Distribution of LinkedIn Users' Age")
```

We see that LinkedIn users tend to be on the younger side as the data are skewed right. This makes sense since LinkedIn is a networking platform and older people are less likely to be searching for jobs. We see practically no users of age 70 or greater.

```{r}

```

