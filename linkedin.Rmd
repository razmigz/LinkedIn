---
title: "LinkedIn"
author: "Razmig Zeitounian"
date: "7/23/2021"
output: html_document
---

Data Source: https://www.kaggle.com/killbot/linkedin-profiles-and-jobs-data 

```{r message=FALSE, warning=FALSE}
library(tidyverse)
library(ISLR)
library(e1071)
library(knitr)

df <- read_csv("LinkedIn.csv") %>% 
  # drop ID column
  select(-X1)

# we will treat country as a factor (rather than as a character) since it is a variable with one level (au)
df$country <- as.factor(df$country)
# treat isPremium as a factor (0 = No, 1 = Yes)?
df$isPremium <- as.factor(df$isPremium)
```

We show a quick preview of our data to make the data easier to understand.

```{r}
head(df, 10)
```

In particular, our variables are as follows.

```{r}
colnames(df)
```


Let's see the top 50 companies to work for from our sample. 

```{r}
(top.50.companies <- df %>% 
  group_by(companyName) %>% 
  count() %>% 
  arrange(desc(n)) %>% 
  head(50)
)
```

We can visualize the number of employees at each company with a barplot.

```{r}
# we will reorder to show the companies with the most employees at the top of the chart for readability
ggplot(top.50.companies, aes(x=reorder(companyName, n), y=n)) +
  geom_bar(stat = "identity", fill = "seagreen2", col = "pink") +
  coord_flip() +
  labs(x = "Company", y = "Number of Employees on LinkedIn", title = "Number of Employees Per Company on LinkedIn") 
```

Telstra has the most employees on LinkedIn by a good amount. 
We start by checking how many observations we have and seeing how many of these individuals have at least 500 connections.

```{r}
dim(df)
at.least.500c <- df %>% 
  count(connectionsCount >= 500)

ggplot(as.data.frame(at.least.500c), aes(`connectionsCount >= 500`, n, label = n)) + 
  geom_bar(stat = "identity", col = "blue", fill = "pink") +
  labs(x = "User has 500+ Connections", y= "Number of Users", title = "Number of LinkedIn Users with 500+ Connections") +
  geom_text(hjust = 0.5, vjust = 10.5)
```

Another area we may be interested in is the age distribution of LinkedIn members.

```{r}
ggplot(df, aes(ageEstimate)) +
  geom_histogram(col = "cornsilk2", fill = "indianred", binwidth = 5) +
  labs(title = "Distribution of LinkedIn Users' Age", x = "Age Estimate", y = "Count")
```

We see that LinkedIn users tend to be on the younger side as the data are skewed right. This makes sense since LinkedIn is a networking platform and older people are less likely to be searching for jobs. We see practically no users of age 70 or greater.


We may be interested in predicting if a user has at least 500 connections. To get an idea of how many users in our data have 500 connections or more, we make a simple table showing counts, as well as one showing percentages.

```{r}
df %>% 
  group_by(atLeast500c) %>% 
  summarize(count = n(), p = n()/nrow(df))
```

